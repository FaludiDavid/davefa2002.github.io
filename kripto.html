import yfinance as yf
import pandas as pd

# Kriptók ticker szimbólumai
symbols = {
    'Bitcoin': 'BTC-USD',
    'Ethereum': 'ETH-USD',
    'Dogecoin': 'DOGE-USD'
}

# Üres lista az adatok tárolására
crypto_data = []

# 5 évre letöltjük az adatokat mindhárom kriptóra
for name, ticker in symbols.items():
    df = yf.download(ticker, period='5y', interval='1d')
    df.reset_index(inplace=True)
    df['Crypto'] = name
    df['Date'] = pd.to_datetime(df['Date'])
    df['Price'] = df['Close']  # csak a záróár kell
    crypto_data.append(df[['Date', 'Price', 'Crypto']])

# Az összesített DataFrame
combined_df = pd.concat(crypto_data, ignore_index=True)

import yfinance as yf
import pandas as pd
import plotly.graph_objects as go
import plotly.io as pio

# → Colab-hoz renderer beállítása
pio.renderers.default = "colab"

# 1) Adatok lekérése az elmúlt 5 évre
btc_data = yf.download('BTC-USD', period='5y', interval='1d')

# 2) Indexből oszloppá alakítás (Date)
btc_data.reset_index(inplace=True)
btc_data['Date'] = pd.to_datetime(btc_data['Date'])

# 3) Átnevezés: a záróár legyen 'Price' (ha szeretnéd)
btc_data['Price'] = btc_data['Close']

# 4) Hover-szöveg előállítása két lépésben, hogy ne keletkezzen hiba
btc_data['Date_str']  = btc_data['Date'].dt.strftime('%Y-%m-%d')
btc_data['Price_str'] = btc_data['Price'].map(lambda x: f"${x:,.2f}")
btc_data['hover_text'] = "Dátum: " + btc_data['Date_str'] + "<br>Záróár: " + btc_data['Price_str']

# 5) Interaktív vonaldiagram Plotly-val
fig = go.Figure(
    go.Scatter(
        x=btc_data['Date'],
        y=btc_data['Price'],
        mode='lines',
        line=dict(color='darkorange', width=0.6),
        hovertext=btc_data['hover_text'],
        hoverinfo='text'
    )
)

# 6) Layout beállítások
fig.update_layout(
    title="Bitcoin árfolyam időbeli alakulása (Yahoo Finance)",
    xaxis_title="Dátum",
    yaxis_title="Záróár (USD)",
    template="simple_white",
    hovermode="x unified"
)

# 7) Ábra megjelenítése
fig.show()

